{% extends "index.html" %}

{% set g = {
    "page":"quarteis",
    "abas":{
        "add":{
            "title":"Adicionar",
            "id":"add",
            "action":"/quartel/add"
        },
        "list":{
            "title":"Listar",
            "id":"list",
            "action":"/quartel/list"
        },
        "edit":{
            "title":"Editar",
            "id":"edit",
            "action":"/quartel/edit"
        },
    },
    "selected_aba":aba

} %}

{% if aba != "edit" %}
    {% set temp = g.abas.pop("edit") %}
{% endif %}

{% block page %}

    {% if aba == "add" %}
        {{ add() }}
    {% elif aba == "edit" %}
        {{ edit() }}
    {% elif aba == "list" %}
        {{ list() }}
    {% endif %}


{% endblock %}


{% macro add() %}
    <form action="/quartel/add" method="post">
        <div class="field-container">
            <div class="field-name">
                <label for="fieldName">Name:</label>
            </div>
            <div class="field-input">
                <input autocomplete="off" autofocus class="only" name="name" placeholder="Name" type="text">
            </div>
        </div>
        <div class="field-container">
            <div class="field-name">
                <label for="fieldName">Sigla:</label>
            </div>
            <div class="field-input">
                <input autocomplete="off" autofocus class="only" name="sigla" placeholder="Sigla" type="text">
            </div>
        </div>
        <div class="field-container">
            <div class="field-name">
                <label for="fieldName">Efetivo:</label>
            </div>
            <div class="field-input">
                <input autocomplete="off" autofocus class="only" name="efetivo" placeholder="Efetivo" type="number">
            </div>
        </div>
        <div class="field-container">
            <div class="field-name">
                <label for="fieldName">Area:</label>
            </div>
            <div class="field-input">
                <input type="number" class="before" name="area" placeholder="Area" >
                <span class="after">m<sup>2</sup></span>
            </div>
        </div>
        <div class="field-container">
            <div class="field-name">
                <label for="fieldName">Demanda Contratada:</label>
            </div>
            <div class="field-input">
                <input type="number" class="before" name="demanda_contratada" placeholder="Demanda Contratada" >
                <span class="after">kWh</span>
            </div>
        </div>
        <div class="field-container">
            <div class="field-name">
                <label for="fieldName">Grupo Tarifario:</label>
            </div>
            <div class="field-input">
                <select name="grupo_tarifario" class="only" >
                    <option disable selected>Grupo</option>
                    <option value="A" >A</option>
                    <option value="B" >B</option>
                </select>
            </div>
        </div>
        <button type="submit">Adicionar</button>
    </form>
{% endmacro %}

{% macro list() %}
    <div class="diagram-container">
        <div class="items">
            <ul>
                {{ recursive_list(subordinados) }}
            </ul>
        </div>
    </div>
{% endmacro %}

{% macro recursive_list(sublist) %}
    {% for sub in sublist %}
        <li>
            <a href={{"/quartel/select/" + sub}}>
                <img src="{{url_for('static', filename='images/placeholder_brasao.png')}}" alt="">
                <span>{{sub}}</span>
            </a>
            {% if sublist[sub]|length %}
                <ul>
                    {{ recursive_list(sublist[sub]) }}
                </ul>
            {% endif %}
        </li>
    {% endfor %}
{% endmacro %}